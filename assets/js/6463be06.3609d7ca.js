(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8845],{4105:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return N},frontMatter:function(){return c},metadata:function(){return k},toc:function(){return g}});var a=n(7560),i=n(8283),o=n(2784),r=n(9037),s=n(5277),l="figure_bGOi",p="figure__caption_2D4m",d="figure__title_36_x",m="arrow_1ZYI";function h(e){var t=e.html,n=e.snapshot,a=e.caption,i=e.title,r=decodeURIComponent(t),h=decodeURIComponent(n);return o.createElement("figure",{className:l},i&&o.createElement("div",{className:d},i),o.createElement(s.Z,{title:"HTML",className:"html"},r),o.createElement("div",{className:m},"\u2193"),o.createElement(s.Z,{title:"TRT",className:"xml"},h),a&&o.createElement("figcaption",{className:p},a))}var c={id:"transient-render-engine",title:"Transient Render Engine",sidebar_position:3,description:"An overview of the transient render engine features in react-native-render-html."},k={unversionedId:"flow/transient-render-engine",id:"flow/transient-render-engine",isDocsHomePage:!1,title:"Transient Render Engine",description:"An overview of the transient render engine features in react-native-render-html.",source:"@site/docs/flow/transient-render-engine.mdx",sourceDirName:"flow",slug:"/flow/transient-render-engine",permalink:"/react-native-render-html/docs/flow/transient-render-engine",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/flow/transient-render-engine.mdx",version:"current",sidebarPosition:3,frontMatter:{id:"transient-render-engine",title:"Transient Render Engine",sidebar_position:3,description:"An overview of the transient render engine features in react-native-render-html."},sidebar:"docSidebar",previous:{title:"DOM Tampering",permalink:"/react-native-render-html/docs/guides/dom-tampering"},next:{title:"CSS Processing",permalink:"/react-native-render-html/docs/flow/css-processing"}},g=[{value:"Element Models",id:"element-models",children:[{value:"HTMLElementModel",id:"htmlelementmodel",children:[]},{value:"HTMLContentModel",id:"htmlcontentmodel",children:[]}]},{value:"Steps",id:"steps",children:[{value:"Translation",id:"translation",children:[]},{value:"Hoisting",id:"hoisting",children:[]},{value:"Whitespace Collapsing",id:"whitespace-collapsing",children:[]}]},{value:"Anatomy of a TNode",id:"anatomy-of-a-tnode",children:[]},{value:"Markers",id:"markers",children:[]}],u={toc:g};function N(e){var t=e.components,n=(0,i.Z)(e,["components"]);return(0,r.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"This article is an introduction to the ","\u200b",(0,r.kt)("abbr",{about:"A module capable of transforming a DOM tree into a Transient Render Tree",title:"Transient Render Engine"},"TRE")," architecture."),(0,r.kt)("h2",{id:"element-models"},"Element Models"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Element models")," form the building block of the engine. These models specify how a DOM element of a peculiar tag should be translated. You can tamper with those models and add you own models, making this library extremly customizable."),(0,r.kt)("h3",{id:"htmlelementmodel"},"HTMLElementModel"),(0,r.kt)("p",null,"To each standard tag is attached an ",(0,r.kt)("strong",{parentName:"p"},"element model"),", instance of the ",(0,r.kt)("inlineCode",{parentName:"p"},"HTMLElementModel")," class. Such model has multiple fields describing different behaviors related to translation of those DOM elements:"),(0,r.kt)("ol",{style:{listStyleType:"decimal"}},(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"contentModel"),": How should this tag be translated? See next chapter.")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"isVoid"),": Will be ",(0,r.kt)("inlineCode",{parentName:"p"},"true")," for void aka ",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Glossary/Empty_element"},"empty elements")," , e.g. DOM elements which can","'","t have children.")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"isOpaque"),": Will be ",(0,r.kt)("inlineCode",{parentName:"p"},"true")," for those elements which children should not be translated. Useful for ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/svg"},"<","svg",">")," and other custom markups.")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"mixedUAStyles"),": Mixed User-Agent styles, e.g. default styles for this element. This is how default styles are set for tags.")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"getUADerivedStyleFromAttributes"),": A function which returns mixed UA styles given the DOM node ",(0,r.kt)("strong",{parentName:"p"},"attributes")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"TNode")," ",(0,r.kt)("strong",{parentName:"p"},"markers"),"."))),(0,r.kt)("h3",{id:"htmlcontentmodel"},"HTMLContentModel"),(0,r.kt)("p",null,"There are 4 content models that can be attached to a tag:"),(0,r.kt)("ol",{style:{listStyleType:"decimal"}},(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"textual")," for elements which can be translated to ",(0,r.kt)("inlineCode",{parentName:"p"},"TText")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"TPhrasing"),". Examples: ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/span"},"<","span",">"),", ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/strong"},"<","strong",">")," ...")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"block")," for elements which can only be translated to",(0,r.kt)("inlineCode",{parentName:"p"},"TBlock"),". Examples: ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/div"},"<","div",">"),", ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/p"},"<","p",">"),", ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/article"},"<","article",">")," ...")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"mixed")," (rare) for elements which can be translated to",(0,r.kt)("inlineCode",{parentName:"p"},"TText"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"TPhrasing")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"TBlock"),". The sole mixed elements are ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/a"},"<","a",">"),", ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/ins"},"<","ins",">")," and ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/del"},"<","del",">"),".")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"none")," for element which shall not be rendered. Examples: ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/button"},"<","button",">"),", ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/map"},"<","map",">")," ..."))),(0,r.kt)("p",null,"A powerful feature of the ",(0,r.kt)("strong",{parentName:"p"},"Foundry")," engine is that the models attached to a tag name can be customized! See the ",(0,r.kt)("a",{parentName:"p",href:"/docs/guides/custom-renderers"},"Custom Rendering")," page."),(0,r.kt)("h2",{id:"steps"},"Steps"),(0,r.kt)("p",null,"The ","\u200b",(0,r.kt)("abbr",{about:"Structured data matching closely the React tree to render.",title:"Transient Render Tree"},"TRT")," construction is broadly comprised of three steps."),(0,r.kt)("h3",{id:"translation"},"Translation"),(0,r.kt)("p",null,"Each DOM element is translated to a ",(0,r.kt)("inlineCode",{parentName:"p"},"TNode"),". The translation will obide by the following rules:"),(0,r.kt)("ol",{style:{listStyleType:"disc"}},(0,r.kt)("li",null,(0,r.kt)("p",null,"The root of the document will be translated to a ",(0,r.kt)("inlineCode",{parentName:"p"},"TDocument")," node. This node has a special ",(0,r.kt)("inlineCode",{parentName:"p"},"context")," field which holds metadata harvested in the ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/head"},"<","head",">")," DOM element.")),(0,r.kt)("li",null,(0,r.kt)("p",null,"Text nodes will be translated to ",(0,r.kt)("inlineCode",{parentName:"p"},"TText"),", and will be merged with a parent DOM element if the parent","'","s ",(0,r.kt)("strong",{parentName:"p"},"content model")," is ",(0,r.kt)("strong",{parentName:"p"},"textual")," or ",(0,r.kt)("strong",{parentName:"p"},"mixed")," when they are its only child. For example, a Text node with no siblings which parent is a ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/span"},"<","span",">")," will be merged into a ",(0,r.kt)("inlineCode",{parentName:"p"},"TText")," with",(0,r.kt)("inlineCode",{parentName:"p"},"tagName")," set to ",'"',"span",'"',".")),(0,r.kt)("li",null,(0,r.kt)("p",null,"DOM elements which content model is ",(0,r.kt)("strong",{parentName:"p"},"textual")," with multiple children will be translated to ",(0,r.kt)("inlineCode",{parentName:"p"},"TPhrasing")," nodes.")),(0,r.kt)("li",null,(0,r.kt)("p",null,"DOM elements with children which ",(0,r.kt)("strong",{parentName:"p"},"content model")," is ",(0,r.kt)("strong",{parentName:"p"},"mixed")," will be translated to ",(0,r.kt)("inlineCode",{parentName:"p"},"TPhrasing")," if they only have ",(0,r.kt)("inlineCode",{parentName:"p"},"TPhrasing")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"TText")," children,",(0,r.kt)("inlineCode",{parentName:"p"},"TBlock")," otherwise.")),(0,r.kt)("li",null,(0,r.kt)("p",null,"DOM elements which ",(0,r.kt)("strong",{parentName:"p"},"content model")," is ",(0,r.kt)("strong",{parentName:"p"},"block")," will be translated to ",(0,r.kt)("inlineCode",{parentName:"p"},"TBlock")," nodes.")),(0,r.kt)("li",null,(0,r.kt)("p",null,"Finally, DOM elements which ",(0,r.kt)("strong",{parentName:"p"},"content model")," is ",(0,r.kt)("strong",{parentName:"p"},"none")," will be translated to ",(0,r.kt)("inlineCode",{parentName:"p"},"TEmpty"),".")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/script"},"<","script",">"),", comments and ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/style"},"<","style",">")," DOM nodes will be ignored."))),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"A DOM element might be untranslatable for a variety of reasons. For example, its name is not a standard HTML5 element and there is no custom HTML element model registered for it. An other reason is that it is an interactive element such as a form, input or button.\n"))),(0,r.kt)("p",null,"In addition, inline styles, User Agent styles and mixed styles are processed by the CSS Processor, see ",(0,r.kt)("a",{parentName:"p",href:"/docs/flow/css-processing"},"CSS Processing")," for more details."),(0,r.kt)("p",null,"Below is an example of a ",(0,r.kt)("strong",{parentName:"p"},"translation")," transformation from HTML to ","\u200b",(0,r.kt)("abbr",{about:"Structured data matching closely the React tree to render.",title:"Transient Render Tree"},"TRT"),":"),(0,r.kt)(h,{caption:"This flow depicts the translation step. The TRT is represented in a JSX-like format thanks to TNode.snapshot() method.",html:"%3Ca%20href%3D%22https%3A%2F%2Fdomain.com%22%3E%0AThis%20is%0A%3Cspan%3Ephrasing%20content%3C%2Fspan%3E%0A%3Cimg%20src%3D%22https%3A%2F%2Fdomain.com%2Flogo.jpg%22%20%2F%3E%0A%20%20%20%20and%20this%20is%20%3Cstrong%3Etoo%3C%2Fstrong%3E.%0A%3C%2Fa%3E",snapshot:"%3CTDocument%20tagName%3D%22html%22%3E%0A%20%20%3CTBlock%20tagName%3D%22body%22%3E%0A%20%20%20%20%3CTPhrasing%20tagName%3D%22a%22%20href%3D%22https%3A%2F%2Fdomain.com%22%3E%0A%20%20%20%20%20%20%3CTText%20anonymous%20data%3D%22%5CnThis%20is%5Cn%22%20%2F%3E%0A%20%20%20%20%20%20%3CTText%20tagName%3D%22span%22%20data%3D%22phrasing%20content%22%20%2F%3E%0A%20%20%20%20%20%20%3CTText%20anonymous%20data%3D%22%5Cn%22%20%2F%3E%0A%20%20%20%20%20%20%3CTBlock%20tagName%3D%22img%22%20src%3D%22https%3A%2F%2Fdomain.com%2Flogo.jpg%22%20%2F%3E%0A%20%20%20%20%20%20%3CTText%20anonymous%20data%3D%22%5Cn%20%20%20%20and%20this%20is%20%22%20%2F%3E%0A%20%20%20%20%20%20%3CTText%20tagName%3D%22strong%22%20data%3D%22too%22%20%2F%3E%0A%20%20%20%20%20%20%3CTText%20anonymous%20data%3D%22.%5Cn%22%20%2F%3E%0A%20%20%20%20%3C%2FTPhrasing%3E%0A%20%20%3C%2FTBlock%3E%0A%3C%2FTDocument%3E",mdxType:"TNodeTransformDisplay"}),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"You will notice that a ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/body"},"<","body",">")," has been added, and the root is an instance of ",(0,r.kt)("inlineCode",{parentName:"p"},"TDocument"),". This process is called ",(0,r.kt)("strong",{parentName:"p"},"normalization"),", and is also performed by Web browsers.\n"))),(0,r.kt)("h3",{id:"hoisting"},"Hoisting"),(0,r.kt)("p",null,"The ",(0,r.kt)("strong",{parentName:"p"},"hoisting phase")," consists in enforcing a basic constraint:"),(0,r.kt)("div",{className:"admonition admonition-important alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"The Hoisting Constraint")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"A ",(0,r.kt)("inlineCode",{parentName:"p"},"TPhrasing")," node should only have ",(0,r.kt)("inlineCode",{parentName:"p"},"TText"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"TPhrasing")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"TEmpty")," nodes as children.\n"))),(0,r.kt)("p",null,"Therefore, any ",(0,r.kt)("inlineCode",{parentName:"p"},"TBlock")," child of a ",(0,r.kt)("inlineCode",{parentName:"p"},"TPhrasing")," node will be recursively ",(0,r.kt)("strong",{parentName:"p"},"hoisted")," to the parent, until it meets that constraint. This constraint must be enforced to insure that a React Native ",(0,r.kt)("a",{parentName:"p",href:"https://reactnative.dev/docs/Text"},"Text")," elements have no ",(0,r.kt)("a",{parentName:"p",href:"https://reactnative.dev/docs/View"},"View")," children, since it will break the default box model and might lead to bugs and inconsistencies. This constraint is depicted below:"),(0,r.kt)("div",{className:"admonition admonition-important alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"The View Constraint")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"React Native ",(0,r.kt)("a",{parentName:"p",href:"https://reactnative.dev/docs/Text"},"Text")," elements should not have ",(0,r.kt)("a",{parentName:"p",href:"https://reactnative.dev/docs/View"},"View")," elements as children.\n"))),(0,r.kt)("p",null,"On one hand ",(0,r.kt)("inlineCode",{parentName:"p"},"TBlock")," will be translated to ",(0,r.kt)("a",{parentName:"p",href:"https://reactnative.dev/docs/View"},"View")," elements and on the other hand ",(0,r.kt)("inlineCode",{parentName:"p"},"TPhrasing")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"TText")," nodes will be translated to ",(0,r.kt)("a",{parentName:"p",href:"https://reactnative.dev/docs/Text"},"Text")," elements. Therefore, enforcing ",(0,r.kt)("strong",{parentName:"p"},"The Hoisting Constraint")," in the ","\u200b",(0,r.kt)("abbr",{about:"Structured data matching closely the React tree to render.",title:"Transient Render Tree"},"TRT")," results in enforcing ",(0,r.kt)("strong",{parentName:"p"},"The View Constraint")," at render time. You can disable ",(0,r.kt)("strong",{parentName:"p"},"hoisting")," via ",(0,r.kt)("a",{parentName:"p",href:"/api/interfaces/renderhtmlprops#dangerouslydisablehoisting"},"dangerouslyDisableHoisting")," prop, but be advised this is yet experimental."),(0,r.kt)("p",null,"Below is an example of ",(0,r.kt)("strong",{parentName:"p"},"translation + hoisting")," transformation from HTML to ","\u200b",(0,r.kt)("abbr",{about:"Structured data matching closely the React tree to render.",title:"Transient Render Tree"},"TRT"),":"),(0,r.kt)(h,{caption:"Notice that contrary to the translate-only example, the <a> element is now wrapped in a TBlock. Also, text preceding and following the <img> tag are wrapped in an anonymous TPhrasing node.",html:"%3Ca%20href%3D%22https%3A%2F%2Fdomain.com%22%3E%0AThis%20is%0A%3Cspan%3Ephrasing%20content%3C%2Fspan%3E%0A%3Cimg%20src%3D%22https%3A%2F%2Fdomain.com%2Flogo.jpg%22%20%2F%3E%0A%20%20%20%20and%20this%20is%20%3Cstrong%3Etoo%3C%2Fstrong%3E.%0A%3C%2Fa%3E",snapshot:"%3CTDocument%20tagName%3D%22html%22%3E%0A%20%20%3CTBlock%20tagName%3D%22body%22%3E%0A%20%20%20%20%3CTBlock%20tagName%3D%22a%22%20href%3D%22https%3A%2F%2Fdomain.com%22%3E%0A%20%20%20%20%20%20%3CTPhrasing%20anonymous%3E%0A%20%20%20%20%20%20%20%20%3CTText%20anonymous%20data%3D%22%5CnThis%20is%5Cn%22%20%2F%3E%0A%20%20%20%20%20%20%20%20%3CTText%20tagName%3D%22span%22%20data%3D%22phrasing%20content%22%20%2F%3E%0A%20%20%20%20%20%20%20%20%3CTText%20anonymous%20data%3D%22%5Cn%22%20%2F%3E%0A%20%20%20%20%20%20%3C%2FTPhrasing%3E%0A%20%20%20%20%20%20%3CTBlock%20tagName%3D%22img%22%20src%3D%22https%3A%2F%2Fdomain.com%2Flogo.jpg%22%20%2F%3E%0A%20%20%20%20%20%20%3CTPhrasing%20anonymous%3E%0A%20%20%20%20%20%20%20%20%3CTText%20anonymous%20data%3D%22%5Cn%20%20%20%20and%20this%20is%20%22%20%2F%3E%0A%20%20%20%20%20%20%20%20%3CTText%20tagName%3D%22strong%22%20data%3D%22too%22%20%2F%3E%0A%20%20%20%20%20%20%20%20%3CTText%20anonymous%20data%3D%22.%5Cn%22%20%2F%3E%0A%20%20%20%20%20%20%3C%2FTPhrasing%3E%0A%20%20%20%20%3C%2FTBlock%3E%0A%20%20%3C%2FTBlock%3E%0A%3C%2FTDocument%3E",mdxType:"TNodeTransformDisplay"}),(0,r.kt)("h3",{id:"whitespace-collapsing"},"Whitespace Collapsing"),(0,r.kt)("p",null,"The ",(0,r.kt)("strong",{parentName:"p"},"whitespace collapsing phase")," consists in implementing the algorithm associated with the ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/white-space"},"white-space")," CSS property, depicted in the ",(0,r.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/css-text-3/"},"CSS Text Module Level 3")," standard, by which unsignificant white-spaces are removed from the ","\u200b",(0,r.kt)("abbr",{about:"Structured data matching closely the React tree to render.",title:"Transient Render Tree"},"TRT"),". You can disable ",(0,r.kt)("strong",{parentName:"p"},"hoisting")," via ",(0,r.kt)("a",{parentName:"p",href:"/api/interfaces/renderhtmlprops#dangerouslydisablewhitespacecollapsing"},"dangerouslyDisableWhitespaceCollapsing")," prop, but be advised this is yet experimental."),(0,r.kt)("p",null,"Below is an example of ",(0,r.kt)("strong",{parentName:"p"},"translating + hoisting + collapsing")," transformation from HTML to ","\u200b",(0,r.kt)("abbr",{about:"Structured data matching closely the React tree to render.",title:"Transient Render Tree"},"TRT"),":"),(0,r.kt)(h,{caption:"Notice when comparing with the previous example, the line returns and extraneous spaces have been removed.",html:"%3Ca%20href%3D%22https%3A%2F%2Fdomain.com%22%3E%0AThis%20is%0A%3Cspan%3Ephrasing%20content%3C%2Fspan%3E%0A%3Cimg%20src%3D%22https%3A%2F%2Fdomain.com%2Flogo.jpg%22%20%2F%3E%0A%20%20%20%20and%20this%20is%20%3Cstrong%3Etoo%3C%2Fstrong%3E.%0A%3C%2Fa%3E",snapshot:"%3CTDocument%20tagName%3D%22html%22%3E%0A%20%20%3CTBlock%20tagName%3D%22body%22%3E%0A%20%20%20%20%3CTBlock%20tagName%3D%22a%22%20href%3D%22https%3A%2F%2Fdomain.com%22%3E%0A%20%20%20%20%20%20%3CTPhrasing%20anonymous%3E%0A%20%20%20%20%20%20%20%20%3CTText%20anonymous%20data%3D%22This%20is%20%22%20%2F%3E%0A%20%20%20%20%20%20%20%20%3CTText%20tagName%3D%22span%22%20data%3D%22phrasing%20content%22%20%2F%3E%0A%20%20%20%20%20%20%3C%2FTPhrasing%3E%0A%20%20%20%20%20%20%3CTBlock%20tagName%3D%22img%22%20src%3D%22https%3A%2F%2Fdomain.com%2Flogo.jpg%22%20%2F%3E%0A%20%20%20%20%20%20%3CTPhrasing%20anonymous%3E%0A%20%20%20%20%20%20%20%20%3CTText%20anonymous%20data%3D%22and%20this%20is%20%22%20%2F%3E%0A%20%20%20%20%20%20%20%20%3CTText%20tagName%3D%22strong%22%20data%3D%22too%22%20%2F%3E%0A%20%20%20%20%20%20%20%20%3CTText%20anonymous%20data%3D%22.%22%20%2F%3E%0A%20%20%20%20%20%20%3C%2FTPhrasing%3E%0A%20%20%20%20%3C%2FTBlock%3E%0A%20%20%3C%2FTBlock%3E%0A%3C%2FTDocument%3E",mdxType:"TNodeTransformDisplay"}),(0,r.kt)("h2",{id:"anatomy-of-a-tnode"},"Anatomy of a TNode"),(0,r.kt)("p",null,"A ",(0,r.kt)("inlineCode",{parentName:"p"},"TNode")," has the following relevant fields:"),(0,r.kt)("ol",{style:{listStyleType:"decimal"}},(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"attributes"),": The list of attributes attached to the underlying DOM Node.")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"id"),": The id attached to the underlying DOM Node.")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"classes"),": An array of classes associated with the underlying DOM Node.")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"domNode"),": The underlying DOM Node, if present.")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"tagName"),": The tag name attached to the underlying DOM Node.")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"parent"),": The parent ",(0,r.kt)("inlineCode",{parentName:"p"},"TNode"),", if present, determined ",(0,r.kt)("strong",{parentName:"p"},"before hoisting"),".")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"nodeIndex"),": The position of this element relative to its parent, ",(0,r.kt)("strong",{parentName:"p"},"before hoisting")," and ",(0,r.kt)("strong",{parentName:"p"},"after whitespace collapsing"),".")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"children"),": An array of ",(0,r.kt)("inlineCode",{parentName:"p"},"TNode")," descendents to this node.")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"type"),": The ",(0,r.kt)("strong",{parentName:"p"},"type")," of this ",(0,r.kt)("inlineCode",{parentName:"p"},"TNode"),". Either ",(0,r.kt)("strong",{parentName:"p"},"text"),", ",(0,r.kt)("strong",{parentName:"p"},"phrasing"),", ",(0,r.kt)("strong",{parentName:"p"},"block"),", ",(0,r.kt)("strong",{parentName:"p"},"document")," or ",(0,r.kt)("strong",{parentName:"p"},"empty"),".")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"markers"),": A registry of markers for this ",(0,r.kt)("inlineCode",{parentName:"p"},"TNode"),". See explaination in below section.")),(0,r.kt)("li",null,(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"snapshot()"),": A utility function to create a JSX-like string representation of this node and its children. ",(0,r.kt)("strong",{parentName:"p"},"Very handy for debugging.")))),(0,r.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"styles")," field which is not listed here ",(0,r.kt)("strong",{parentName:"p"},"is not")," consumable as a React Native component ",(0,r.kt)("inlineCode",{parentName:"p"},"style")," prop.\n"))),(0,r.kt)("h2",{id:"markers"},"Markers"),(0,r.kt)("p",null,"Markers form an abstraction in which one ",(0,r.kt)("inlineCode",{parentName:"p"},"TNode")," provides semantic information to itself and all its descendants. For example, ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/ins"},"<","ins",">")," elements, which stand for ",'"',"insertion",'"'," of content in the context of an edit will provide the ",(0,r.kt)("inlineCode",{parentName:"p"},"edits")," marker with value ",(0,r.kt)("inlineCode",{parentName:"p"},"&quot;ins&quot;")," to all its descendants. Similarly, ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/a"},"<","a",">"),", ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/ol"},"<","ol",">")," and ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/ul"},"<","ul",">")," elements will set their own markers. List markers such as ",(0,r.kt)("inlineCode",{parentName:"p"},"olNestLevel")," are integers which are incremented each time a list is nested."),(0,r.kt)("p",null,"Markers can also be derived from attributes. This is the case with ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/attribute/dir"},"dir")," and ",(0,r.kt)("a",{parentName:"p",href:"https://mdn.io/attribute/lang"},"lang")," attributes. Finally, you can customize the markers extraction logic with ",(0,r.kt)("a",{parentName:"p",href:"/api/interfaces/renderhtmlprops#setmarkersfortnode"},"setMarkersForTNode")," prop."))}N.isMDXComponent=!0}}]);